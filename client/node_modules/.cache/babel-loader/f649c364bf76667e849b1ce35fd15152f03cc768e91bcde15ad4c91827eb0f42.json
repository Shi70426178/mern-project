{"ast":null,"code":"import _objectSpread from\"C:/mern-project/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useEffect,useState}from'react';import axios from'axios';import styles from'./BrowseProducts.module.css';// Ensure this CSS module exists\nimport Navigation from'./Navigation';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BrowseProducts=_ref=>{let{username}=_ref;const[products,setProducts]=useState([]);const[search,setSearch]=useState('');const[message,setMessage]=useState('');useEffect(()=>{const fetchProducts=async()=>{try{const res=await axios.get('https://mern-project-5-xoai.onrender.com/api/products');if(Array.isArray(res.data)){setProducts(res.data);}else{console.error('Unexpected response data:',res.data);}console.log('Products fetched successfully:',res.data);}catch(err){console.error('Error fetching products:',err);setMessage('Error fetching products');}};fetchProducts();},[]);const handleLike=async productId=>{try{const res=await axios.post(\"https://mern-project-5-xoai.onrender.com/api/products/\".concat(encodeURIComponent(productId),\"/like\"),{username});if(res.data&&typeof res.data.likes==='number'){setProducts(products.map(product=>product._id===productId?_objectSpread(_objectSpread({},product),{},{likes:res.data.likes,likedBy:res.data.likedBy}):product));}else{console.error('Unexpected response data:',res.data);}}catch(err){console.error('Error toggling like on product:',err);setMessage('Error toggling like on product');}};const handleComment=async(productId,comment)=>{try{const res=await axios.post(\"https://mern-project-5-xoai.onrender.com/api/products/\".concat(encodeURIComponent(productId),\"/comment\"),{comment});if(res.data&&Array.isArray(res.data.comments)){setProducts(products.map(product=>product._id===productId?_objectSpread(_objectSpread({},product),{},{comments:res.data.comments}):product));}else{console.error('Unexpected response data:',res.data);}}catch(err){console.error('Error commenting on product:',err);setMessage('Error commenting on product');}};const filteredProducts=products.filter(product=>product.name.toLowerCase().includes(search.toLowerCase()));return/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsx(Navigation,{}),/*#__PURE__*/_jsx(\"h2\",{children:\"Browse Products\"}),message&&/*#__PURE__*/_jsx(\"p\",{className:styles.error,children:message}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search products...\",value:search,onChange:e=>setSearch(e.target.value),className:styles.searchInput}),/*#__PURE__*/_jsx(\"div\",{className:styles.productGrid,children:filteredProducts.length>0?filteredProducts.map(product=>/*#__PURE__*/_jsxs(\"div\",{className:styles.productCard,children:[/*#__PURE__*/_jsx(\"h3\",{children:product.name}),/*#__PURE__*/_jsx(\"p\",{children:product.description}),/*#__PURE__*/_jsx(\"a\",{href:\"https://mern-project-5-xoai.onrender.com/api/products/files/\".concat(product.fileUrl.split('/').pop()),download:true,children:\"Download\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleLike(product._id),children:[product.likedBy.includes(username)?'Unlike':'Like',\" (\",product.likes,\")\"]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.commentsSection,children:[product.comments&&product.comments.length>0?product.comments.map((comment,index)=>/*#__PURE__*/_jsx(\"p\",{children:comment},index)):/*#__PURE__*/_jsx(\"p\",{children:\"No comments yet.\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:e=>{e.preventDefault();handleComment(product._id,e.target.comment.value);e.target.comment.value='';},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"comment\",placeholder:\"Add a comment...\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Comment\"})]})]})]},product._id)):/*#__PURE__*/_jsx(\"p\",{children:\"No products found\"})})]});};export default BrowseProducts;","map":{"version":3,"names":["React","useEffect","useState","axios","styles","Navigation","jsx","_jsx","jsxs","_jsxs","BrowseProducts","_ref","username","products","setProducts","search","setSearch","message","setMessage","fetchProducts","res","get","Array","isArray","data","console","error","log","err","handleLike","productId","post","concat","encodeURIComponent","likes","map","product","_id","_objectSpread","likedBy","handleComment","comment","comments","filteredProducts","filter","name","toLowerCase","includes","className","container","children","type","placeholder","value","onChange","e","target","searchInput","productGrid","length","productCard","description","href","fileUrl","split","pop","download","onClick","commentsSection","index","onSubmit","preventDefault","required"],"sources":["C:/mern-project/client/src/components/BrowseProducts.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport styles from './BrowseProducts.module.css'; // Ensure this CSS module exists\r\nimport Navigation from './Navigation';\r\n\r\nconst BrowseProducts = ({ username }) => {\r\n    const [products, setProducts] = useState([]);\r\n    const [search, setSearch] = useState('');\r\n    const [message, setMessage] = useState('');\r\n\r\n    useEffect(() => {\r\n        const fetchProducts = async () => {\r\n            try {\r\n                const res = await axios.get('https://mern-project-5-xoai.onrender.com/api/products');\r\n                if (Array.isArray(res.data)) {\r\n                    setProducts(res.data);\r\n                } else {\r\n                    console.error('Unexpected response data:', res.data);\r\n                }\r\n                console.log('Products fetched successfully:', res.data);\r\n            } catch (err) {\r\n                console.error('Error fetching products:', err);\r\n                setMessage('Error fetching products');\r\n            }\r\n        };\r\n        fetchProducts();\r\n    }, []);\r\n\r\n    const handleLike = async (productId) => {\r\n        try {\r\n            const res = await axios.post(`https://mern-project-5-xoai.onrender.com/api/products/${encodeURIComponent(productId)}/like`, { username });\r\n            if (res.data && typeof res.data.likes === 'number') {\r\n                setProducts(products.map(product =>\r\n                    product._id === productId ? { ...product, likes: res.data.likes, likedBy: res.data.likedBy } : product\r\n                ));\r\n            } else {\r\n                console.error('Unexpected response data:', res.data);\r\n            }\r\n        } catch (err) {\r\n            console.error('Error toggling like on product:', err);\r\n            setMessage('Error toggling like on product');\r\n        }\r\n    };\r\n\r\n    const handleComment = async (productId, comment) => {\r\n        try {\r\n            const res = await axios.post(`https://mern-project-5-xoai.onrender.com/api/products/${encodeURIComponent(productId)}/comment`, { comment });\r\n            if (res.data && Array.isArray(res.data.comments)) {\r\n                setProducts(products.map(product =>\r\n                    product._id === productId ? { ...product, comments: res.data.comments } : product\r\n                ));\r\n            } else {\r\n                console.error('Unexpected response data:', res.data);\r\n            }\r\n        } catch (err) {\r\n            console.error('Error commenting on product:', err);\r\n            setMessage('Error commenting on product');\r\n        }\r\n    };\r\n\r\n    const filteredProducts = products.filter(product =>\r\n        product.name.toLowerCase().includes(search.toLowerCase())\r\n    );\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <Navigation />\r\n            <h2>Browse Products</h2>\r\n            {message && <p className={styles.error}>{message}</p>}\r\n            <input\r\n                type=\"text\"\r\n                placeholder=\"Search products...\"\r\n                value={search}\r\n                onChange={(e) => setSearch(e.target.value)}\r\n                className={styles.searchInput}\r\n            />\r\n            <div className={styles.productGrid}>\r\n                {filteredProducts.length > 0 ? (\r\n                    filteredProducts.map(product => (\r\n                        <div key={product._id} className={styles.productCard}>\r\n                            <h3>{product.name}</h3>\r\n                            <p>{product.description}</p>\r\n                            <a href={`https://mern-project-5-xoai.onrender.com/api/products/files/${product.fileUrl.split('/').pop()}`} download>Download</a>\r\n                            <button onClick={() => handleLike(product._id)}>\r\n                                {product.likedBy.includes(username) ? 'Unlike' : 'Like'} ({product.likes})\r\n                            </button>\r\n                            <div className={styles.commentsSection}>\r\n                                {product.comments && product.comments.length > 0 ? product.comments.map((comment, index) => (\r\n                                    <p key={index}>{comment}</p>\r\n                                )) : <p>No comments yet.</p>}\r\n                                <form onSubmit={(e) => {\r\n                                    e.preventDefault();\r\n                                    handleComment(product._id, e.target.comment.value);\r\n                                    e.target.comment.value = '';\r\n                                }}>\r\n                                    <input type=\"text\" name=\"comment\" placeholder=\"Add a comment...\" required />\r\n                                    <button type=\"submit\">Comment</button>\r\n                                </form>\r\n                            </div>\r\n                        </div>\r\n                    ))\r\n                ) : (\r\n                    <p>No products found</p>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BrowseProducts;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}