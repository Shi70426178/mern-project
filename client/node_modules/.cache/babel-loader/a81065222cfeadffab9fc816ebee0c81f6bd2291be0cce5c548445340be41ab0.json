{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import styles from'./PremiumProducts.module.css';// Ensure this CSS module exists\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PremiumProducts=()=>{const[premiumProducts,setPremiumProducts]=useState([]);const[message,setMessage]=useState('');const[purchasedProducts,setPurchasedProducts]=useState([]);const username=localStorage.getItem('username');// Retrieve username from local storage\nuseEffect(()=>{const fetchPremiumProducts=async()=>{try{const res=await axios.get('http://localhost:5000/api/products/premium');if(Array.isArray(res.data)){setPremiumProducts(res.data);}else{console.error('Unexpected response data:',res.data);}console.log('Premium products fetched successfully:',res.data);}catch(err){console.error('Error fetching premium products:',err);setMessage('Error fetching premium products');}};fetchPremiumProducts();},[]);const handleBuy=async productId=>{console.log('Purchasing product ID:',productId);// Debugging line to verify product ID\nconsole.log('Username for purchase:',username);// Debugging line to verify username\ntry{const res=await axios.post(\"http://localhost:5000/api/products/premium/\".concat(productId,\"/buy\"),{username},{headers:{'Content-Type':'application/json'}});if(res.data&&res.data.message==='Purchase successful'){setPurchasedProducts([...purchasedProducts,productId]);console.log('Product purchased successfully:',res.data);}else{console.error('Unexpected response data:',res.data);}}catch(err){console.error('Error purchasing product:',err);setMessage('Error purchasing product');}};return/*#__PURE__*/_jsxs(\"div\",{className:styles.container,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Premium Products\"}),message&&/*#__PURE__*/_jsx(\"p\",{className:styles.error,children:message}),/*#__PURE__*/_jsx(\"div\",{className:styles.productGrid,children:premiumProducts.length>0?premiumProducts.map(product=>/*#__PURE__*/_jsxs(\"div\",{className:styles.productCard,children:[/*#__PURE__*/_jsx(\"h3\",{children:product.name}),/*#__PURE__*/_jsx(\"p\",{children:product.description}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Price: $\",product.price]}),purchasedProducts.includes(product._id)?/*#__PURE__*/_jsx(\"a\",{href:\"http://localhost:5000/api/products/files/\".concat(product.fileUrl.split('/').pop()),download:true,children:\"Download\"}):/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleBuy(product._id),children:\"Buy Now\"}),/*#__PURE__*/_jsxs(\"div\",{className:styles.details,children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Likes: \",product.likes]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Comments: \",product.comments.length]})]})]},product._id)):/*#__PURE__*/_jsx(\"p\",{children:\"No premium products found\"})})]});};export default PremiumProducts;","map":{"version":3,"names":["React","useEffect","useState","axios","styles","jsx","_jsx","jsxs","_jsxs","PremiumProducts","premiumProducts","setPremiumProducts","message","setMessage","purchasedProducts","setPurchasedProducts","username","localStorage","getItem","fetchPremiumProducts","res","get","Array","isArray","data","console","error","log","err","handleBuy","productId","post","concat","headers","className","container","children","productGrid","length","map","product","productCard","name","description","price","includes","_id","href","fileUrl","split","pop","download","onClick","details","likes","comments"],"sources":["C:/mern-project/client/src/components/PremiumProducts.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport styles from './PremiumProducts.module.css'; // Ensure this CSS module exists\r\n\r\nconst PremiumProducts = () => {\r\n    const [premiumProducts, setPremiumProducts] = useState([]);\r\n    const [message, setMessage] = useState('');\r\n    const [purchasedProducts, setPurchasedProducts] = useState([]);\r\n    const username = localStorage.getItem('username'); // Retrieve username from local storage\r\n\r\n    useEffect(() => {\r\n        const fetchPremiumProducts = async () => {\r\n            try {\r\n                const res = await axios.get('http://localhost:5000/api/products/premium');\r\n                if (Array.isArray(res.data)) {\r\n                    setPremiumProducts(res.data);\r\n                } else {\r\n                    console.error('Unexpected response data:', res.data);\r\n                }\r\n                console.log('Premium products fetched successfully:', res.data);\r\n            } catch (err) {\r\n                console.error('Error fetching premium products:', err);\r\n                setMessage('Error fetching premium products');\r\n            }\r\n        };\r\n        fetchPremiumProducts();\r\n    }, []);\r\n\r\n    const handleBuy = async (productId) => {\r\n        console.log('Purchasing product ID:', productId); // Debugging line to verify product ID\r\n        console.log('Username for purchase:', username); // Debugging line to verify username\r\n\r\n        try {\r\n            const res = await axios.post(`http://localhost:5000/api/products/premium/${productId}/buy`, { username }, {\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                }\r\n            });\r\n            if (res.data && res.data.message === 'Purchase successful') {\r\n                setPurchasedProducts([...purchasedProducts, productId]);\r\n                console.log('Product purchased successfully:', res.data);\r\n            } else {\r\n                console.error('Unexpected response data:', res.data);\r\n            }\r\n        } catch (err) {\r\n            console.error('Error purchasing product:', err);\r\n            setMessage('Error purchasing product');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <h2>Premium Products</h2>\r\n            {message && <p className={styles.error}>{message}</p>}\r\n            <div className={styles.productGrid}>\r\n                {premiumProducts.length > 0 ? (\r\n                    premiumProducts.map(product => (\r\n                        <div key={product._id} className={styles.productCard}>\r\n                            <h3>{product.name}</h3>\r\n                            <p>{product.description}</p>\r\n                            <p>Price: ${product.price}</p>\r\n                            {purchasedProducts.includes(product._id) ? (\r\n                                <a href={`http://localhost:5000/api/products/files/${product.fileUrl.split('/').pop()}`} download>Download</a>\r\n                            ) : (\r\n                                <button onClick={() => handleBuy(product._id)}>Buy Now</button>\r\n                            )}\r\n                            <div className={styles.details}>\r\n                                <p>Likes: {product.likes}</p>\r\n                                <p>Comments: {product.comments.length}</p>\r\n                            </div>\r\n                        </div>\r\n                    ))\r\n                ) : (\r\n                    <p>No premium products found</p>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default PremiumProducts;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}